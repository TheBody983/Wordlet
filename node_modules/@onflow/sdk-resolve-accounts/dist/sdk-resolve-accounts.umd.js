!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@onflow/interaction")):"function"==typeof define&&define.amd?define(["exports","@onflow/interaction"],e):e((n=n||self).sdkResolveAccounts={},n.interaction)}(this,function(n,e){function r(){return(r=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}return n}).apply(this,arguments)}var t="undefined"!=typeof Symbol?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function o(n,e,r){if(!n.s){if(r instanceof i){if(!r.s)return void(r.o=o.bind(null,n,e));1&e&&(e=r.s),r=r.v}if(r&&r.then)return void r.then(o.bind(null,n,e),o.bind(null,n,2));n.s=e,n.v=r;var t=n.o;t&&t(n)}}var i=function(){function n(){}return n.prototype.then=function(e,r){var t=new n,i=this.s;if(i){var u=1&i?e:r;if(u){try{o(t,1,u(this.v))}catch(n){o(t,2,n)}return t}return this}return this.o=function(n){try{var i=n.v;1&n.s?o(t,1,e?e(i):i):r?o(t,1,r(i)):o(t,2,i)}catch(n){o(t,2,n)}},t},n}();function u(n){return n instanceof i&&1&n.s}var c=function(n){return"function"==typeof n},a=function(n){return"number"==typeof n},s=function(n){return"string"==typeof n},f=function(n,e){if(!n){var r,t=new Error("INVARIANT "+e);throw t.stack=t.stack.split("\n").filter(function(n){return!/at invariant/.test(n)}).join("\n"),(r=console).error.apply(r,["\n\n---\n\n",t,"\n\n"].concat([].slice.call(arguments,2),["\n\n---\n\n"])),t}},l=function(n){return!(n.role.proposer&&!(s(n.addr)&&a(n.keyId)&&a(n.sequenceNum)&&c(n.signingFunction))||n.role.payer&&!(s(n.addr)&&a(n.keyId)&&c(n.signingFunction))||n.role.authorizer&&!(s(n.addr)&&a(n.keyId)&&c(n.signingFunction)))},d=function(n){return void 0===n&&(n=[]),n.filter(Boolean)[0]||null},p=function(n){return void 0===n&&(n=[]),n.find(function(n){return n.role.proposer})||{}},v=function(n){try{var r=function(){return e.Ok(n)};if(!e.isTransaction(n))return Promise.resolve(e.Ok(n));var a=function(n,e,r){if("function"==typeof n[t]){var c,a,s,f=n[t]();if(function n(r){try{for(;!(c=f.next()).done;)if((r=e(c.value))&&r.then){if(!u(r))return void r.then(n,s||(s=o.bind(null,a=new i,2)));r=r.v}a?o(a,1,r):a=r}catch(n){o(a||(a=new i),2,n)}}(),f.return){var l=function(n){try{c.done||f.return()}catch(n){}return n};if(a&&a.then)return a.then(l,function(n){throw l(n)});l()}return a}if(!("length"in n))throw new TypeError("Object is not iterable");for(var d=[],p=0;p<n.length;p++)d.push(n[p]);return function(n,e,r){var t,c,a=-1;return function r(s){try{for(;++a<n.length;)if((s=e(a))&&s.then){if(!u(s))return void s.then(r,c||(c=o.bind(null,t=new i,2)));s=s.v}t?o(t,1,s):t=s}catch(n){o(t||(t=new i),2,n)}}(),t}(d,function(n){return e(d[n])})}(Object.entries(n.accounts),function(e){var r=e[0],t=e[1];function o(){f(l(n.accounts[r]),"Account unable to fulfill role",n.accounts[r])}var i=function(){if(c(t.resolve))return Promise.resolve(t.resolve(t)).then(function(e){n.accounts[r]=e})}();return i&&i.then?i.then(o):o()});return Promise.resolve(a&&a.then?a.then(r):r())}catch(n){return Promise.reject(n)}},h=function(n){try{if(!e.isTransaction(n))return Promise.resolve(e.Ok(n));for(var t=function(){var e,t,u,c=i[o],s=c.addr+"|"+c.keyId;n.accounts[s]=null!=n.accounts[s]?(e=n.accounts[s],t=r({tempId:s},c),{kind:d([e.kind,t.kind]),tempId:d([e.tempId,t.tempId]),addr:d([e.addr,t.addr]),keyId:(u=[e.keyId,t.keyId],void 0===u&&(u=[]),"number"==typeof u.filter(a)[0]?u.filter(a)[0]:null),sequenceNum:"number"==typeof p([e,t]).sequenceNum?p([e,t]).sequenceNum:e.sequenceNum,signature:d([e.signature,t.signature]),signingFunction:d([e.signingFunction,t.signingFunction]),resolve:d([e.resolve,t.resolve]),role:{proposer:e.role.proposer||t.role.proposer,authorizer:e.role.authorizer||t.role.authorizer,payer:e.role.payer||t.role.payer,param:e.role.param||t.role.param}}):r({tempId:s},c),n.proposer===c.tempId&&(n.proposer=s),n.payer===c.tempId&&(n.payer=s),n.authorizations=n.authorizations.map(function(n){return n===c.tempId?s:n}),delete n.accounts[c.tempId]},o=0,i=Object.values(n.accounts);o<i.length;o++)t();for(var u=0,c=Object.values(n.accounts);u<c.length;u++){var s=c[u];f(l(s),"Account unable to fulfill roles",s)}return Promise.resolve(e.Ok(n))}catch(n){return Promise.reject(n)}},y=e.pipe([v,h]);n.dedupeResolvedAccounts=h,n.enforceResolvedAccounts=v,n.resolveAccounts=y});
//# sourceMappingURL=sdk-resolve-accounts.umd.js.map
