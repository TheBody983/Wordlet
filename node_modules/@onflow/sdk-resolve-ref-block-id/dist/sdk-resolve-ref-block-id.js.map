{"version":3,"file":"sdk-resolve-ref-block-id.js","sources":["../src/index.js"],"sourcesContent":["import {isTransaction, Ok, interaction, pipe} from \"@onflow/interaction\"\nimport {send} from \"@onflow/send\"\nimport {decodeResponse} from \"@onflow/decode\"\nimport {getLatestBlock} from \"@onflow/sdk-build-get-latest-block\"\n\nasync function getRefId (opts) {\n  var ix\n  ix = await pipe(interaction(), [getLatestBlock()])\n  ix = await send(ix, opts)\n  ix = await decodeResponse(ix)\n  return ix.id\n}\n\nexport function resolveRefBlockId(opts) {\n  return async ix => {\n    if (!isTransaction(ix)) return Ok(ix)\n    if (ix.message.refBlock) return Ok(ix)\n\n    ix.message.refBlock = await getRefId(opts)\n\n    return Ok(ix)\n  }\n}\n"],"names":["opts","ix","isTransaction","message","refBlock","Ok","pipe","interaction","getLatestBlock","send","decodeResponse","id","getRefId"],"mappings":"8KAakCA,GAChC,gBAAaC,OACX,OAAKC,gBAAcD,GACfA,EAAGE,QAAQC,yBAAiBC,KAAGJ,6BAXdD,OACvB,IAAIC,EADyB,uBAElBK,OAAKC,gBAAe,CAACC,uCAFH,OAE7BP,oBACWQ,OAAKR,EAAID,qBAHS,OAG7BC,oBACWS,iBAAeT,qBAC1B,OADAA,KACUU,4CAQoBC,CAASZ,qBAErC,OAFAC,EAAGE,QAAQC,WAEJC,KAAGJ,qBALqBI,KAAGJ,IADpC"}