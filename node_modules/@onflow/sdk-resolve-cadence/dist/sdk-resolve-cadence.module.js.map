{"version":3,"file":"sdk-resolve-cadence.module.js","sources":["../src/index.js"],"sourcesContent":["import {isTransaction, isScript, get, Ok, Bad} from \"@onflow/interaction\"\n\nfunction ignore(ix) {\n  return !(isTransaction(ix) || isScript(ix))\n}\n\nasync function fetchParam(param) {\n  return typeof param.resolve === \"function\"\n    ? { ...param, ...await param.resolve(), tempId: param.tempId }\n    : param\n}\n\nexport async function resolveCadence (ix) {\n  try {\n    if (ignore(ix)) return Ok(ix)\n\n    const cadence = get(ix, \"ix.cadence\")\n\n    if (typeof cadence === \"string\") {\n      ix.message.cadence = cadence\n      return Ok(ix)\n\n    } else if (typeof cadence === \"function\") {\n      if (Object.values(ix.params).length >= 1) {\n        console.error(\n          `\n          %cFCL/SDK Deprecation Notice\n          ============================\n\n          Interopolation of functions into template literals will not be a thing in future versions of the Flow-JS-SDK or FCL.\n          You can learn more (including a guide on common transition paths) here: https://github.com/onflow/flow-js-sdk/blob/master/packages/sdk/TRANSITIONS.md#0001-deprecate-params\n\n          ============================\n        `,\n          \"font-weight:bold;font-family:monospace;\"\n        )\n      }\n      const params = Object.fromEntries(Object.values(ix.params).map(p => [p.key, p.value]))\n      ix.message.cadence = await cadence(params)\n      return Ok(ix)\n    } else {\n      throw new Error(`ix.cadence had a type of: \"${typeof cadence}\", but it must needs to be a \"string\" or a \"function\" that returns a string.`)\n    }\n  } catch (error) {\n    return Bad(ix, error)\n  }\n}\n"],"names":["resolveCadence","ix","body","recover","result","isTransaction","isScript","ignore","Ok","cadence","get","message","Object","values","params","length","console","error","fromEntries","map","p","key","value","Error","e","then","Bad"],"mappings":"4FAYsBA,IAAAA,WAAgBC,8BAsiB/B,SAAgBC,EAAMC,GAC5B,IACC,IAAIC,aAtiBF,GAZJ,SAAgBH,GACd,QAASI,EAAcJ,IAAOK,EAASL,IAWjCM,CAAON,GAAK,OAAOO,EAAGP,GAE1B,IAAMQ,EAAUC,EAAIT,EAAI,cAHtB,GAKqB,iBAAZQ,EAET,OADAR,EAAGU,QAAQF,QAAUA,EACdD,EAAGP,MAEkB,mBAAZQ,EAAwB,CACpCG,OAAOC,OAAOZ,EAAGa,QAAQC,QAAU,GACrCC,QAAQC,scAUN,2CAGJ,IAAMH,EAASF,OAAOM,YAAYN,OAAOC,OAAOZ,EAAGa,QAAQK,IAAI,SAAAC,SAAK,CAACA,EAAEC,IAAKD,EAAEE,UAftC,uBAgBbb,EAAQK,qBACnC,OADAb,EAAGU,QAAQF,UACJD,EAAGP,KAEV,UAAUsB,2CAA2Cd,kFA2gB5CP,GACZ,MAAMsB,GACP,OAAOrB,EAAQqB,GAEhB,OAAIpB,GAAUA,EAAOqB,KACbrB,EAAOqB,UAAK,EAAQtB,GAErBC,cAhhBGa,GACP,OAAOS,EAAIzB,EAAIgB,MAhCnB"}